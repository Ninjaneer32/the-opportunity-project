{% assign item = include.data %}
{% assign ps = "" | split: "," %}
{% for statement in item.problem_statements %}
  {% assign match = site.data.problem_statements | where: "airtable_id", statement | first %}
  {% assign name = match.Name | slugify %}
  {% assign ps = ps | push: name %}
{% endfor %}

<li id="data-set-card-{{item.name | slugify}}" class="desktop:grid-col-4 tablet:grid-col-4 usa-card__dataset margin-bottom-2 data-set-card" name="data-set-card">
  <div class="usa-card__container datasets__card bg-primary-darker usa-dark-background">
    <header class="usa-card__header">
      <h2 class="usa-card__heading text-white font-sans-md" value="{{data.name | slugify}}">
        {% unless item.hasMultipleLinks %}
          <a href="{{item.link}}" target="_blank"
            class="usa-link" aria-label="{{ item.name }}">                
            {{ item.name }}
          </a>
        {% else %}
          {{ item.name }}
        {% endunless %}
      </h2>
      {% assign filters = ps %}
      {% if page.problem-statement-name %}
        {% assign filters = item.tag %}
      {% endif %}
      <span class="pc-inactive dataset__ps">
        {% for filter in filters %}{{ filter | slugify }} {% endfor %}
      </span>
      <p class="dataset__org font-mono-xs text-white">by {{ item.organization_text | upcase }}</p>
    </header>
    <div class="usa-card__body">
      <p class="font-sans-xs text-white">{{ item.description}}</p>
      {% if item.hasMultipleLinks %}
        <p>There are mutiple links associated with this data set. Please refer to the list below: </p>
        {% assign listed-links = item.link | split: "- " | slice: 1, 100 %}
        <ul>
        {% for listed-link in listed-links %}
          <li>
            {{ listed-link | markdownify }}
          </li>
        {% endfor %}
        </ul>
      {% endif %}
    </div>
    {% if item.data_stewards %}
      <div class="usa-card__footer">
        {% comment %} Display "Data Steward" if email, "Contact Page" if url {% endcomment %}
        {% assign steward = site.data.people | where: "airtable_id", item.data_stewards[0] | first %}
        {% assign firstFourEmailChars = steward.email | slice: 0, 4 %}
        {% assign isContactPage = false %}
        {% if firstFourEmailChars == "http" %}
          {% assign isContactPage = true %}
        {% endif %}
        <h3 class="text-medium margin-bottom-05">
          {% if isContactPage %}
            Contact Page:
          {% else %}
            Data Steward{% if item.data_stewards.size > 1 %}s{% endif %}:
          {% endif %}
        </h3>
        <ul class="padding-left-3">
          {% for steward_id in item.data_stewards %}
            {% assign steward = site.data.people | where: "airtable_id", steward_id | first %}
            {% assign firstFourEmailChars = steward.email | slice: 0, 4 %}
            {% assign isContactPage = false %}
            {% if firstFourEmailChars == "http" %}
              {% assign isContactPage = true %}
            {% endif %}
            <li>
              {% if isContactPage %}
                <a href="{{ steward.email }}" class="usa-link">
                  {{ steward.name | strip }}
                </a>
              {% else %}
                {{ steward.name | strip }}, 
                <a href="mailto:{{ steward.email }}?subject=Regarding The Opportunity Project Dataset: {{steward.name}}" 
                class="usa-link">
                  {{ steward.email }}
                </a>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}
  </div>
</li>