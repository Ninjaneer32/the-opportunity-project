{% assign data-topics = include.data %}
{% assign checkboxSets = include.checkboxSets %}

{% if data-topics.size > 1 %}
  
  {% if checkboxSets == null %}
    
    <div class="grid-row grid-gap">
      <ul class="data-card-group margin-top-7">
        {% for data in data-topics %}
          {% assign filter = data.Name | slugify | default: data %}
          <li>
            <div 
              id="{{ filter | slugify }}" 
              class="dch__data-topic {%if forloop.first %}selected{% endif %}"
            >
              <header class="padding-x-2">
                <p class="font-sans-sm" value="{{ filter | downcase }}">{{ data.Name | default: filter | camelcase }}</p>
              </header>
            </div>
          </li>
        {% endfor %}
      </ul>
    </div>
    <hr class="margin-top-3 margin-bottom-0 border-accent-warm">
  
  {% else %}
    
    <div class="grid-row grid-gap text-white margin-top-3">
      <div class="mobile-lg:grid-col-4">
        <fieldset class="usa-fieldset">
          <legend class="usa-legend">Filter by category</legend>
          {% assign categoryHalf = data-topics.size | divided_by: 2.0 | ceil %}
          <div class="grid-container grid-row grid-gap padding-x-0">
            <div class="grid-col-6 padding-left-0">
              {% for data in data-topics limit:categoryHalf %}
                {% include dch/dch__radio-button.html data=data %}
              {% endfor %}
            </div>
            <div class="grid-col-6 padding-right-0">
              {% for data in data-topics offset:categoryHalf %}
                {% include dch/dch__radio-button.html data=data %}
              {% endfor %}
            </div>
          </div>
        </fieldset>
      </div>
      {% for group in checkboxSets %}
      <div class="mobile-lg:grid-col-6 mobile-lg:grid-offset-1 margin-top-4 mobile-lg:margin-top-0">
        <fieldset class="usa-form dch__checkbox-group" name="{{group}}">
          <legend class="usa-legend">Filter by available {{group}}</legend>
          {% comment %} get all options for the given field {% endcomment %}
          {% assign options = "" | split: ',' %}
          {% for dataset in site.data.treasury_datasets %}
            {% for option in dataset[group] %}
              {% assign geography = site.data.geographies | where: "airtable_id", option %}
              {% assign options = options | push: geography %}
            {% endfor %}
          {% endfor %}
          {% assign options = options | uniq | sort: "order" %}
          {% for option in options %}
          <div class="usa-checkbox dch-checkbox">
              <input
                class="usa-checkbox__input"
                id="{{option.name | slugify}}"
                type="checkbox"
                name="{{group | slugify}}"
                value="{{option.name | slugify}}"
              />
              <label class="usa-checkbox__label" for="{{option.name | slugify}}">
                {{ option.name }}
              </label>
          </div>
          {% endfor %}
        </fieldset>
      </div>
      {% endfor %}
    </div>

  {% endif %}
{% endif %}